name: Verify ChM Mirror

on:
  workflow_dispatch:
  schedule:
    - cron: '0 * * * *'  # Runs every hour

jobs:
  verify-mirror:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout source repo (C-HASH-P)
      uses: actions/checkout@v3
      with:
        repository: UNIVERSE-DAO/C-HASH-P
        path: source

    - name: Checkout mirror repo (SIG3)
      uses: actions/checkout@v3
      with:
        repository: 4RK-OFF/universe.dao-sig3
        path: mirror

    - name: Compare ChM-2.txt files
      run: |
        echo "Comparing ChM-2.txt from both repos..."
        diff source/messages/ChM-2.txt mirror/messages/ChM-2.txt || {
          echo "::error ::Mismatch found in ChM-2.txt between repos.";
          exit 1;
        }
        echo "âœ… ChM-2.txt files are identical."
